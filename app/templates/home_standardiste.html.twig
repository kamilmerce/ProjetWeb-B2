{% extends "base_auth.html.twig" %}

{% block body %}
<style>
body {
  font-family: 'Arial', sans-serif;
  background-image: url('/img/login.png'); 
  background-size: cover;
  background-repeat: no-repeat; 
  background-attachment: fixed; 
  background-position: center center; 
  color: white; 
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
}

.liste-container {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.liste{
  background: rgba(255, 255, 255, 0.25);
  border-radius: 20px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  width: 700px;
  height: 600px;
  align-items: center;
  margin-right:30px;
  margin-top:20px;
}

.liste table {
    width: 100%;
    border-collapse: separate; 
    border-spacing: 0; 
}

h1 {
  font-weight: bold;
  margin-top: 20px;
  margin-bottom:0px;
  color:white;
  top:0;
  position: sticky; 
  z-index: 1000;
  background-color: #3A559F; /* Ajout de cette ligne */
  padding: 10px; /* Ajout de cette ligne */
}

select, input[type=text], button {
  width: 35%;
  height: 35%;
  padding: 10px;
  border: none;
  border-radius: 40px;
  background-color: #3A559F; 
  text-align: center;
  color: white;
  cursor: pointer;
  margin-top: 20px;
}

th, td {
  padding: 10px;
}

.liste td {
    border-bottom: 2px solid white; 
}

.liste th {
    border-bottom: 2px solid white; 
    background-color: #3A559F;
    color:white;
    top:57px;
    position: sticky; 
    z-index: 1000; 

}

a {
  display: block;
  width: 100%;
  text-align: right;
  text-decoration: none;
  color: #3A559F;
}

@media (max-width: 1200px) {
  div {
    width: 450px;
  }
}

@media (max-width: 900px) {
  div {
    width: 100%;
  }
}
</style>
<body>
    {% if user.role == 'standardiste' %}
    <div class="liste-container">
        <div class = "liste" style="width: 1300px; height: 570px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; margin-bottom: 20px;">
            <table>
                <thead>
                    <h1>Liste des interventions</h1>
                    <tr>
                        <th>ID</th>
                        <th>Date de début</th>
                        <th>Client</th>
                        <th>Standardiste</th>
                        <th>Infos</th>
                        <th>Commentaires</th>
                        <th>Status</th>
                        <th>Degré d'urgence</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for intervention in interventions %}
                    <tr>
                        <td>{{ intervention.id }}</td>
                        <td>{{ intervention.start_date }}</td>
                        <td>{{ intervention.client_id }}</td>
                        <td>{{ intervention.standardiste_id }}</td>
                        <td>{{ intervention.infos }}</td>
                        <td>
                            <div style="width: 300px; height: 100px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; margin-bottom: 20px;">
                                {% for commentaire in commentaires %}
                                    {% if commentaire.intervention_id == intervention.id %}
                                        <div class="comment">
                                            <span class="comment-author">{{ commentaire.user_name }} {{ commentaire.user_surname }}</span>
                                            <span class="comment-date">{{ commentaire.date_commentaire}}</span>
                                            <p class="comment-content">{{ commentaire.commentaire}}</p>
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </td>
                        <td>{{ intervention.status_suivi }}</td>
                        <td>{{ intervention.degre_urgence }}</td>
                        <td>
                            {% if intervention.standardiste_id == user.user_id %}
                                <a href="edit_intervention.php?id={{ intervention.id }}">Edit</a>
                            {% else %}
                            <a href="viewmore.php?type=intervention&id={{ intervention.id }}">View more</a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}
</body>
{% endblock %}
